<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="style.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="pretty.js"></script> 
  </head>
  <body>

    <script>

      $(document).ready(function(){
        var $body = $('body');
        var totalTweets;
        $body.html('');
        //Add a button at the top to refresh tweets
        $body.append('<button type = "button">Click for more tweets</button>')
        $body.append('<div id="tweets"></div>');

        var formatTweet = function(tweet) {//takes all the information in the tweet 
                                            //object and makes it readable
            
            
           var $tweet = $('<div class="tweet"></div>');
          $tweet.append('<p class="time">Tweeted ' + prettyDate(tweet.created_at) + "</p><a class = 'handle' href = '#'>@" + tweet.user + "</a><p class='message'>" + tweet.message + "</p>");
          return $tweet;
        }

       
        totalTweets=0;

        var getTweets = function (stream,start) { //Retrieves all new tweets
        var index = start;
        while(index < stream.length){
          var tweet = stream[index];
         
         var $tweet = formatTweet(tweet); 
          $('#tweets').prepend($tweet); //inserts them at the top after the button
          index += 1;
        }
        if (totalTweets < stream.length) {
        totalTweets = stream.length;
      }
      }

      getTweets(streams.home,0, totalTweets); //initial 10 tweets as the page loads
      

        $('button').click(function(event) {getTweets(streams.home, totalTweets)}); // gets new tweets every time the button is clicked

      $(function(){
        $(document).on('click', 'a',(function(){
          var user = $(this).text();
          user = user.slice(1);
          $('.tweet').addClass('hide');
          getTweets(streams.users[user],0);
  }));
});
      });

    </script>
  </body>
</html>
