<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="style.css">
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <script src="pretty.js"></script> 
  </head>
  <body>

    <script>

      $(document).ready(function(){
        var $body = $('body');
        var totalTweets;
        $body.html('');
        //Add a button at the top to refresh tweets
        $body.append('<button type = "button">Click for more tweets</button>')
        $body.append('<div id="tweets"></div>');

        var formatTweet = function(tweet) {//takes all the information in the tweet 
                                            //object and makes it readable
            
            
           var $tweet = $('<div></div>');
          $tweet.append('<p class="time">Tweeted ' + prettyDate(tweet.created_at) + "</p><h1 class='handle'>@" + tweet.user + "</h1><p class='message'>" + tweet.message + "</p>");
          return $tweet;
        }

       
        totalTweets=0;

        var getTweets = function () { //Retrieves all new tweets
        var index = streams.home.length - 1,
        startIndex=index;
        while(index >= totalTweets){
          var tweet = streams.home[index];
         
         var $tweet = formatTweet(tweet); 
          $('#tweets').prepend($tweet); //inserts them at the top after the button
          index -= 1;
        }
        totalTweets = startIndex;
      }

      getTweets(); //initial 10 tweets as the page loads

        $('button').click(getTweets); // gets new tweets every time the button is clicked


      });

    </script>
  </body>
</html>
